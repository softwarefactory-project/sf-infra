---
# We expect, on the local ansible-playbook runner, a yaml containing
# the pull secret. The yaml is included a vars for ansible-microhsift-role
- name: Read file with openshift_pull_secret
  ansible.builtin.include_vars:
    file: "{{ pull_secret_path }}"
  no_log: true
  delegate_to: localhost

- name: Install microshift
  ansible.builtin.include_role:
    name: "{{ ansible_microshift_role_dir }}"

- name: Install k9s in ~/go/bin
  ansible.builtin.command: go install github.com/derailed/k9s@latest

- name: Create k9s link in /usr/bin
  ansible.builtin.file:
    src: "{{ ansible_user_dir }}/go/bin/k9s"
    dest: /usr/bin/k9s
    state: link
  become: true
