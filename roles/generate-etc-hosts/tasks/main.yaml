- include_vars:
    file: /etc/hosts.yaml

- name: Create /etc/hosts
  copy:
    content: |
      127.0.0.1   localhost {{ ansible_hostname }}
      ::1         localhost {{ ansible_hostname }}

      {% for host in inventory_hosts_ip %}
      {{ host.ip }} {{ host.name }}
      {% endfor %}
    dest: /etc/hosts
  become: yes

- name: Setup ssh config
  become: yes
  copy:
    src: sshconfig
    mode: 0400
    owner: "{{ item.owner }}"
    dest: "{{ item.home }}/.ssh/config"
  loop:
    - home: /home/fedora
      owner: fedora
    - home: /root
      owner: root
  when: manage_ssh_config
