---
# Check if pull-secret.txt is available on the host.
# To download secret, https://cloud.redhat.com/openshift/create/local
- name: Check if pull-secret.txt is available
  stat:
    path: pull-secret.txt
  register: _pull_secret

- name: Fail when pull secret is not available
  fail:
    msg: "Please add pull-secret.txt file"
  when: not _pull_secret.stat.exists and opeshift_pull_secret == ""

- name: Create pull-secret.txt file
  copy:
    content: "{{ opeshift_pull_secret }}"
    dest: pull-secret.txt
  when: not _pull_secret.stat.exists and opeshift_pull_secret != ""
  no_log: "{{ hide_sensitive_logs }}"
