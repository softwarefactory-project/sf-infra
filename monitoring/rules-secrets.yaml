# Code generated by dhall-to-yaml.  DO NOT EDIT.
groups:
  - name: secrets.rules
    rules:
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: To update the secret:\n\n- k1s_token: Use `uuidgen`.\n- k1s_key, k1s_crt and k1s_chain: Create a new certificate with the following commands:\n  openssl genrsa -out ca-key.pem 2048\n  openssl req -new -x509 -subj \"/C=FR\" -days 730 -key ca-key.pem -out ca-cert.pem\n  openssl req -new -newkey rsa:2048 -nodes -subj \"/C=FR/O=K1S/CN=localhost\" -addext \"subjectAltName=DNS:localhost\" -days 730 -keyout key.pem -out req.pem\n  openssl x509 -req -days 730 -extensions v3_ca -CA ca-cert.pem -CAkey ca-key.pem -in req.pem -out cert.pem -extensions san -extfile <(printf \"[san]\\nsubjectAltName=DNS:localhost\")\n  cat cert.pem ca-cert.pem > chain.pem\n  # Encrypt the secrets with ansible-vault:\n  uuidgen | ansible-vault encrypt_string --stdin-name \"k1s_token\"\n  ansible-vault encrypt_string --stdin-name \"k1s_crt\" < ./cert.pem\n  ansible-vault encrypt_string --stdin-name \"k1s_chain\" < ./chain.pem\n  ansible-vault encrypt_string --stdin-name \"k1s_key\" < ./key.pem\n  # Remove the pem files after adding to the vault.\n\nNote: When rotating secrets, all k1s values (token, crt, chain, and key) must be updated together, regardless of their individual 'refreshed' dates. A partial update will cause an SSL mismatch.\n\nAfter merging the sf-infra change, make sure to restart nodepool-launcher service to update the client.\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'k1s_.*'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: To update the secret use `uuidgen`.\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'grafana_pass'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: You need to connect as the zuul user on both pages (see password in bitwarden) and renew the API keys there.\nRestart Zuul with the updated config once the keys have been regenerated.\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'zuul_pagure_token_.*'}) > (15552000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: You need to connect as softwarefactoryio-zuul-bot on gitlab.com (see password in bitwarden) and renew a personal access token.\nMake sure you choose an expiry date of a year when creating the token.\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'zuul_gitlab_com_connection_api_token'}) > (31536000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'cloud_softwarefactory_service_account_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'tenant_builds_zuul_api_url_es_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'tenant_builds_zuul_api_url_es_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'internal_users_admin_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'internal_users_kibanaserver_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'users_admin_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'users_logstash_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'users_curator_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'users_zuul_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'users_admin_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'users_logstash_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'users_curator_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'users_zuul_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'clair_psk_key'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'postgresql_user'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'postgresql_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'postgresql_admin_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'redis_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'database_secret_key'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'secret_key'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_users_admin_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_users_admin_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_users_sf_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_users_tripleo_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_users_tripleo_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_users_zuul_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_organizations_tripleo_tripleomastercentos9_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_organizations_tripleo_tripleowallabycentos9_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_organizations_tripleo_tripleozedcentos9_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_organizations_tripleo_openstack-k8s-operators_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_organizations_tripleo_podified-main-centos9_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_organizations_tripleo_podified-master-centos9_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_organizations_tripleo_podified-zed-centos9_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_organizations_tripleo_podified-antelope-centos9_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'quay_organizations_tripleo_podified-master-centos10_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'install_server_sf_key'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'install_server_rdo_key'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'rhel_activationkey'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'rhel_org_id'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'rhel_pool_ids'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'loki_auth_config_gateway_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'sf_grafana_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'vexxhost_prometheus_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'vexxhost_prometheus_url'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'vexxhost_prometheus_user'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'nextgen_openshift_prometheus_url'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'vexxhost_ceph_s3_access'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'vexxhost_ceph_s3_secret'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'gateway_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'vexxhost_nodepool_rdo_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'ibm_bm3_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'ibm_bm3_url'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'ibm_bm4_password'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'ibm_bm4_url'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'zuul_github_com_connection_webhook_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'zuul_github_com_connection_app_key'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'zuul_github_com_connection_api_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'zuul_gitlab_com_connection_webhook_token'}) > (63072000 - 1209600)"
        labels:
          severity: warning
      - alert: SecretWillExpireInTwoWeeks
        annotations:
          description: "{{ $labels.file }}: Unknown secret expired. Please rotate and add instructions to monitoring/rules-secrets.dhall\n\n\nSee the ansible-vault documentation to perform the actual update."
          summary: "Secret {{ $labels.target }} will expire in two weeks"
        expr: "(time() - sf_infra_secret_age_total{name=~'centOSInfra_zuul_ssh_priv'}) > (63072000 - 1209600)"
        labels:
          severity: warning
