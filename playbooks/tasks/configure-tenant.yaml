- module_defaults:
    group/os:
      auth:
        project_name: "{{ tenant }}"
  block:
    - name: Include tenant configuration
      include_vars:
        file: "{{ tenant }}.yaml"
        name: tenant_config

    - name: Configure tenant networks
      include_role:
        name: manage-networking

    - name: Configure images
      include_role:
        name: manage-image
      loop: "{{ tenant_config.images }}"
      loop_control:
        loop_var: image
