networks:
  - name: private-network
    external_network: public
    port_security_enabled: false

subnets:
  - name: private-subnet
    network_name: private-network
    cidr: 192.168.240.0/24
    gateway_ip: 192.168.240.1
    dns_nameservers:
       - 1.1.1.1
       - 8.8.8.8

routers:
  - name: default-router
    network: public
    interfaces:
      - net: private-network
        subnet: private-subnet
        portip: 192.168.240.1

security_groups:
  - name: common
    rules:
      - port: 22
      - port: -1
        protocol: icmp
  - name: web
    rules:
      - port: 80
      - port: 443
  - name: afs
    rules:
      - port: 8080
      - port: 8081
      - port: 8082
  - name: monitoring
    rules:
      - port: 9100
        remote_ip_prefix: "{{ bridge_public_ip }}/32"
      - port: 9100
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
  - name: rdo-trunk
    rules:
      - port: 3300
  - name: registry
    rules:
      - port: 53
      - port: 2379
      - port: 2380
      - port: 4001
      - port: 5000
      - port: 8443
      - port: 9090
      - port: 10250
      - port: 4789
        protocol: udp
      - port: 8053
        protocol: udp

image_cache_dir: "{{ ansible_user_dir }}/image_cache"
images:
  - name: centos-7-1907
    container_format: bare
    disk_format: qcow2
    url: https://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud-1907.qcow2
    # Via https://cloud.centos.org/centos/7/images/sha256sum.txt
    checksum: 520d01c2f2e1ed24cb2f15a4325aa30773930a2961b5484a68cf11b4a415c512
  - name: fedora-30-1.2
    container_format: bare
    disk_format: qcow2
    url: https://download.fedoraproject.org/pub/fedora/linux/releases/30/Cloud/x86_64/images/Fedora-Cloud-Base-30-1.2.x86_64.qcow2
    # Via https://mirror.csclub.uwaterloo.ca/fedora/linux/releases/30/Cloud/x86_64/images/Fedora-Cloud-30-1.2-x86_64-CHECKSUM
    checksum: 72b6ae7b4ed09a4dccd6e966e1b3ac69bd97da419de9760b410e837ba00b4e26
  - name: centos-8.0-1905
    container_format: bare
    disk_format: qcow2
    # This is a temporary URL, there is no official CentOS 8 qcow2 image, and the previous Koji-based URLs are no longer available
    url: https://jpena.fedorapeople.org/CentOS-8-GenericCloud-8.0.1905-22.x86_64.qcow2
    checksum: c86c119665866695a700a4ab523c774c64ed7e0dd9e6e89f5f032e0f03148a47

keypairs:
  - name: sf-infra-key
    public_key: >-
      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDHj3R7JGtLkSD9h+E6JNHGdZ+SStJx+wyQsE7DK41t+Au7mfTJb12zjxBO4OwzAJbVnudN86BPYI0aHuY7ZpZ8+yitcFOBxQdczcGNistIaOHNb7bp0aPpVTYkHEYo3IlsDgPYcMVsvwOpIIDfi8wSQo3p4FNTtOc9ulAeQ7UUl4uId7ILLGzpDhkRrb+hYetJw/e3Xkqz6BW/VFbw6Tb8DdgMGhNVflQNlPz1HB60zKxeoeRkrLg3lMO/LuFHr48MtWuQ4LR13fq/tw3XgzHIBU2LL107wTtZs3KqxdqEcs9+7gAaNtT9+rbMoQvF0E9viZn+vjHOAbfxgXUEsFt7

# Additional non-root volumes that should be created and attached
volumes:
  - display_name: registry-data
    size: 1024
    server: registry-vexxhost.rdoproject.org
    device: /dev/vdb

servers:
  - name: mirror.regionone.vexxhost.rdoproject.org
    key_name: sf-infra-key
    image: centos-7-1907
    flavor: v1-standard-2
    network: private-network
    floating_ip: yes
    security_groups:
      - afs
      - common
      - web
      - monitoring
    boot_from_volume: yes
    volume_size: 200
  - name: rpm-packaging-ci.rdoproject.org
    key_name: sf-infra-key
    image: centos-7-1907
    # 4 CPUs, 8 GB RAM
    flavor: ci.m1.large
    network: private-network
    floating_ip: yes
    security_groups:
      - common
      - web
      - monitoring
      - rdo-trunk
    boot_from_volume: yes
    volume_size: 100
  - name: fedora-rpm-packaging-ci.rdoproject.org
    key_name: sf-infra-key
    image: fedora-30-1.2
    # 4 CPUs, 8 GB RAM
    flavor: ci.m1.large
    network: private-network
    floating_ip: yes
    security_groups:
      - common
      - web
      - monitoring
      - rdo-trunk
    boot_from_volume: yes
    volume_size: 100
  - name: registry-vexxhost.rdoproject.org
    key_name: sf-infra-key
    image: centos-7-1907
    # 8 CPUs, 16 GB RAM
    flavor: v1-standard-8
    network: private-network
    floating_ip: yes
    security_groups:
      - common
      - web
      - monitoring
      - registry
    boot_from_volume: yes
    volume_size: 200
    volumes:
      - registry-data
  - name: trunk-centos8.rdoproject.org
    key_name: sf-infra-key
    image: centos-8.0-1905
    # 4 CPUs, 16 GB RAM
    flavor: v1-standard-4
    network: private-network
    floating_ip: yes
    security_groups:
      - common
      - web
      - monitoring
      - rdo-trunk
    boot_from_volume: yes
    volume_size: 512
