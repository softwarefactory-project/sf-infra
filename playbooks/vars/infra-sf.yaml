# Code generated by dhall-to-yaml.  DO NOT EDIT.
image_cache_dir: "{{ ansible_user_dir }}/image_cache"
images:
  - checksum: "846574c8a97cd2d8dc1f231062d73107cc85cbbbda56335e264a46e3a6c8ab2f"
    container_format: bare
    disk_format: raw
    name: fedora-43-1.6
    state: absent
    url: https://download.fedoraproject.org/pub/fedora/linux/releases/43/Cloud/x86_64/images/Fedora-Cloud-Base-Generic-43-1.6.x86_64.qcow2
  - checksum: "6193a49c545425f99d23f59ea792f79a7a6b2e3557fc2d3f6d42c3e5274061de"
    container_format: bare
    disk_format: raw
    name: centos-9-stream
    state: present
    url: https://cloud.centos.org/centos/9-stream/x86_64/images/CentOS-Stream-GenericCloud-9-20230605.0.x86_64.qcow2
  - checksum: b1dd527a92721fda5469f511b5d6b4c97cfa18bbf9b002b0fcec08b4e067d28c
    container_format: bare
    disk_format: raw
    name: rhel-9.3-x86_64-kvm
    state: absent
    url: https://redhat.com
  - checksum: d362e72518a2d7415d850b8177c814f6fd87f42ca1640bda17e98855e1d6baad
    container_format: bare
    disk_format: raw
    name: rhel-9.4-x86_64-kvm
    state: present
    url: https://redhat.com
  - checksum: dc74ad1a9ccd3c62a02cc29f7f4715e47fa0fdaf08a8080dd20906f885f29bae
    container_format: bare
    disk_format: raw
    name: rhel-10.1-x86_64-kvm
    state: present
    url: https://redhat.com
keypairs:
  - name: sf-infra-key
    public_key: "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDHj3R7JGtLkSD9h+E6JNHGdZ+SStJx+wyQsE7DK41t+Au7mfTJb12zjxBO4OwzAJbVnudN86BPYI0aHuY7ZpZ8+yitcFOBxQdczcGNistIaOHNb7bp0aPpVTYkHEYo3IlsDgPYcMVsvwOpIIDfi8wSQo3p4FNTtOc9ulAeQ7UUl4uId7ILLGzpDhkRrb+hYetJw/e3Xkqz6BW/VFbw6Tb8DdgMGhNVflQNlPz1HB60zKxeoeRkrLg3lMO/LuFHr48MtWuQ4LR13fq/tw3XgzHIBU2LL107wTtZs3KqxdqEcs9+7gAaNtT9+rbMoQvF0E9viZn+vjHOAbfxgXUEsFt7"
networks:
  - external_network: public
    name: private-network
  - external_network: public
    name: oci-private-network
routers:
  - interfaces:
      - net: private-network
        portip: '192.168.242.1'
        subnet: private-subnet
    name: default-router
    network: public
  - interfaces:
      - net: oci-private-network
        portip: '192.168.254.1'
        subnet: oci-private-subnet
    name: oci-private-router
    network: public
security_groups:
  - name: common
    rules:
      - port: 22
      - port: -1
        protocol: icmp
  - name: web
    rules:
      - port: 80
      - port: 443
  - name: managesf
    rules:
      - port: 1883
      - port: 1884
      - port: 29418
      - port: 64738
      - port: 64738
        protocol: udp
  - name: internal
    rules:
      - port: 1
        port_range_max: 65535
        port_range_min: 1
        protocol: tcp
        remote_ip_prefix: "192.168.0.0/16"
      - port: 1
        port_range_max: 65535
        port_range_min: 1
        protocol: udp
        remote_ip_prefix: "192.168.0.0/16"
  - name: zuul-console
    rules:
      - port: 19885
  - name: zuul-weeder
    rules:
      - port: 9001
  - name: monitoring
    rules:
      - port: 9100
        protocol: tcp
        remote_ip_prefix: "{{ prometheus_private_ip }}/32"
      - port: 9101
        protocol: tcp
        remote_ip_prefix: "{{ prometheus_private_ip }}/32"
      - port: 9102
        protocol: tcp
        remote_ip_prefix: "{{ prometheus_private_ip }}/32"
      - port: 9104
        protocol: tcp
        remote_ip_prefix: "{{ prometheus_private_ip }}/32"
      - port: 9114
        protocol: tcp
        remote_ip_prefix: "{{ prometheus_private_ip }}/32"
      - port: 9100
        protocol: tcp
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
      - port: 9101
        protocol: tcp
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
      - port: 9102
        protocol: tcp
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
      - port: 9104
        protocol: tcp
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
      - port: 9114
        protocol: tcp
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
  - name: prometheus
    rules:
      - port: 7000
        protocol: udp
        remote_ip_prefix: "38.102.83.0/24"
      - port: 7000
        protocol: udp
        remote_ip_prefix: "38.129.56.0/24"
      - port: 7000
        protocol: udp
        remote_ip_prefix: "192.168.242.0/24"
      - port: 7000
        protocol: udp
        remote_ip_prefix: "169.60.49.226/32"
      - port: 7000
        protocol: udp
        remote_ip_prefix: "169.60.49.233/32"
  - name: hypervisor-oci
    rules:
      - port: 19885
      - port: 22022
        port_range_max: 65535
      - port: 9023
        remote_ip_prefix: "38.102.83.114/32"
  - name: hypervisor-oci-open-k1s
    rules:
      - port: 19885
      - port: 22022
        port_range_max: 65535
      - port: 9023
  - name: cs-k1s
    rules:
      - port: 9023
        remote_ip_prefix: "38.102.83.189/32"
  - name: prometheus-mail
    rules:
      - port: 25
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
  - name: elk
    rules:
      - port: 4731
      - port: 9200
        remote_ip_prefix: "192.168.242.0/24"
      - port: 9200
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
      - port: 8125
        protocol: udp
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
      - port: 9114
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
  - name: zookeeper
    rules:
      - port: 2281
        remote_ip_prefix: "{{ ibm_bm3_ip }}/32"
      - port: 2281
        remote_ip_prefix: "{{ ibm_bm4_ip }}/32"
  - name: zookeeper_exporter
    rules:
      - port: 9141
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
  - name: apache_exporter
    rules:
      - port: 9117
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
  - name: k8s-client
    rules:
      - port: 6443
      - port: 30000
  - name: zuul-finger
    rules:
      - port: 7900
servers:
  - boot_from_volume: yes
    flavor: v1-standard-2
    floating_ip: true
    image: rhel-10.1-x86_64-kvm
    key_name: sf-infra-key
    name: bridge-rhel.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
    state: present
    volume_size: 40
  - boot_from_volume: yes
    flavor: v1-standard-2
    floating_ip: true
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: monitoring.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
      - web
      - prometheus
      - apache_exporter
    state: present
    volume_size: 80
  - boot_from_volume: yes
    flavor: v1-standard-2
    floating_ip: true
    image: rhel-9.3-x86_64-kvm
    key_name: sf-infra-key
    name: elk.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
      - elk
    state: present
    volume_size: 50
  - boot_from_volume: yes
    flavor: v1-standard-4
    floating_ip: true
    image: rhel-9.3-x86_64-kvm
    key_name: sf-infra-key
    name: managesf.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
      - web
      - managesf
      - apache_exporter
    state: present
    volume_size: 100
  - boot_from_volume: yes
    flavor: v1-standard-4
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: managesf-dev.softwarefactory-project.io
    network: public
    security_groups:
      - common
      - monitoring
      - internal
      - web
      - managesf
      - apache_exporter
    state: present
    volume_size: 100
  - boot_from_volume: yes
    flavor: v1-standard-2
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: nodepool-builder.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
    state: present
    volume_size: 50
  - boot_from_volume: yes
    flavor: "8vcpu_16GB"
    floating_ip: true
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: k1s03.softwarefactory-project.io
    network: oci-private-network
    security_groups:
      - common
      - monitoring
      - internal
      - hypervisor-oci
    state: present
    volume_size: 100
  - boot_from_volume: yes
    flavor: "4vcpus_8gb"
    floating_ip: true
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: k1s04.softwarefactory-project.io
    network: oci-private-network
    security_groups:
      - common
      - monitoring
      - internal
      - hypervisor-oci
      - cs-k1s
    state: present
    volume_size: 100
  - boot_from_volume: yes
    flavor: "8vcpu_16GB"
    floating_ip: true
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: k1s05.softwarefactory-project.io
    network: oci-private-network
    security_groups:
      - common
      - monitoring
      - internal
      - hypervisor-oci
    state: present
    volume_size: 100
  - boot_from_volume: yes
    flavor: "8vcpu_16GB"
    floating_ip: true
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: k1s06.softwarefactory-project.io
    network: oci-private-network
    security_groups:
      - common
      - monitoring
      - internal
      - hypervisor-oci-open-k1s
    state: present
    volume_size: 100
  - boot_from_volume: yes
    flavor: "4vcpus_8gb"
    floating_ip: true
    image: rhel-9.3-x86_64-kvm
    key_name: sf-infra-key
    name: zk01.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
      - zookeeper
    state: present
    volume_size: 50
  - boot_from_volume: yes
    flavor: v1-standard-2
    image: rhel-9.3-x86_64-kvm
    key_name: sf-infra-key
    name: zs.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
    state: present
    volume_size: 50
  - boot_from_volume: yes
    flavor: "1vcpu_2gb"
    floating_ip: true
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: image-builder.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
      - zuul-console
      - zuul-weeder
    state: present
    volume_size: 50
  - boot_from_volume: yes
    flavor: "8vcpu_16GB"
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: microshift-ze02.softwarefactory-project.io
    network: public
    security_groups:
      - common
      - monitoring
      - internal
      - k8s-client
      - zuul-finger
    state: present
    volume_size: 100
  - boot_from_volume: yes
    flavor: "8vcpu_16GB"
    floating_ip: true
    image: centos-9-stream
    key_name: sf-infra-key
    name: microshift-infra.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
      - web
      - k8s-client
    state: present
    volume_size: 100
  - boot_from_volume: yes
    flavor: v1-standard-2
    floating_ip: true
    image: rhel-9.3-x86_64-kvm
    key_name: sf-infra-key
    name: fedora.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
      - elk
      - apache_exporter
      - web
    state: present
    volume_size: 40
  - boot_from_volume: yes
    flavor: v1-standard-2
    floating_ip: true
    image: rhel-9.3-x86_64-kvm
    key_name: sf-infra-key
    name: ansible.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
      - elk
      - apache_exporter
      - web
    state: present
    volume_size: 40
  - boot_from_volume: no
    flavor: "4vcpus_8gb"
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: ze01.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
    state: present
  - boot_from_volume: no
    flavor: "4vcpus_8gb"
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: ze02.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
    state: present
  - boot_from_volume: no
    flavor: "4vcpus_8gb"
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: ze03.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
    state: present
  - boot_from_volume: no
    flavor: "4vcpus_8gb"
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: ze04.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
    state: present
  - boot_from_volume: no
    flavor: v1-standard-1
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: zm01.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
    state: present
  - boot_from_volume: no
    flavor: v1-standard-1
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: zm02.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
    state: present
  - boot_from_volume: no
    flavor: v1-standard-1
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: zm03.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
    state: present
  - boot_from_volume: no
    flavor: v1-standard-1
    image: rhel-9.4-x86_64-kvm
    key_name: sf-infra-key
    name: zm04.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - internal
    state: present
subnets:
  - cidr: "192.168.242.0/24"
    dns_nameservers:
      - '1.1.1.1'
      - '8.8.8.8'
    gateway_ip: '192.168.242.1'
    name: private-subnet
    network_name: private-network
  - cidr: "192.168.254.0/24"
    dns_nameservers:
      - '1.1.1.1'
      - '8.8.8.8'
    gateway_ip: '192.168.254.1'
    name: oci-private-subnet
    network_name: oci-private-network
volumes:
  - device: /dev/vdb
    display_name: elk-data
    server: elk.softwarefactory-project.io
    size: 160
  - device: /dev/vdb
    display_name: nodepool_builder_lib
    server: nodepool-builder.softwarefactory-project.io
    size: 400
  - device: /dev/vdc
    display_name: nodepool_builder_cache
    server: nodepool-builder.softwarefactory-project.io
    size: 200
  - device: /dev/vdb
    display_name: image-builder-data
    server: image-builder.softwarefactory-project.io
    size: 1000
  - device: /dev/vdb
    display_name: ze02-lvm
    server: microshift-ze02.softwarefactory-project.io
    size: 512
  - device: /dev/vdb
    display_name: microshift-infra-data
    server: microshift-infra.softwarefactory-project.io
    size: 200
  - device: /dev/vdb
    display_name: logs-data
    server: fedora.softwarefactory-project.io
    size: 100
