# This file is managed by dhall.
image_cache_dir: "{{ ansible_user_dir }}/image_cache"
images:
  - checksum: e3c1b309d9203604922d6e255c2c5d098a309c2d46215d8fc026954f3c5c27a0
    container_format: bare
    disk_format: qcow2
    name: fedora-31-1.9
    url: https://download.fedoraproject.org/pub/fedora/linux/releases/31/Cloud/x86_64/images/Fedora-Cloud-Base-31-1.9.x86_64.qcow2
  - checksum: 72b6ae7b4ed09a4dccd6e966e1b3ac69bd97da419de9760b410e837ba00b4e26
    container_format: bare
    disk_format: qcow2
    name: fedora-30-1.2
    url: https://download.fedoraproject.org/pub/fedora/linux/releases/30/Cloud/x86_64/images/Fedora-Cloud-Base-30-1.2.x86_64.qcow2
  - checksum: 520d01c2f2e1ed24cb2f15a4325aa30773930a2961b5484a68cf11b4a415c512
    container_format: bare
    disk_format: qcow2
    name: centos-7-1907
    url: https://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud-1907.qcow2
keypairs:
  - name: sf-infra-key
    public_key: "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDHj3R7JGtLkSD9h+E6JNHGdZ+SStJx+wyQsE7DK41t+Au7mfTJb12zjxBO4OwzAJbVnudN86BPYI0aHuY7ZpZ8+yitcFOBxQdczcGNistIaOHNb7bp0aPpVTYkHEYo3IlsDgPYcMVsvwOpIIDfi8wSQo3p4FNTtOc9ulAeQ7UUl4uId7ILLGzpDhkRrb+hYetJw/e3Xkqz6BW/VFbw6Tb8DdgMGhNVflQNlPz1HB60zKxeoeRkrLg3lMO/LuFHr48MtWuQ4LR13fq/tw3XgzHIBU2LL107wTtZs3KqxdqEcs9+7gAaNtT9+rbMoQvF0E9viZn+vjHOAbfxgXUEsFt7"
networks:
  - external_network: public
    name: private-network
    port_security_enabled: false
  - external_network: public
    name: oci-private-network
    port_security_enabled: false
routers:
  - interfaces:
      - net: private-network
        portip: "192.168.242.1"
        subnet: private-subnet
    name: default-router
    network: public
  - interfaces:
      - net: oci-private-network
        portip: "192.168.254.1"
        subnet: oci-private-subnet
    name: oci-private-router
    network: public
security_groups:
  - name: common
    rules:
      - port: 22
      - port: -1
        protocol: icmp
  - name: web
    rules:
      - port: 80
      - port: 443
  - name: zuul-console
    rules:
      - port: 19885
  - name: monitoring
    rules:
      - port: 9101
        remote_ip_prefix: "{{ bridge_private_ip }}/32"
        state: absent
      - port: 9100
        remote_ip_prefix: "{{ bridge_private_ip }}/32"
        state: absent
      - port: 9101
        remote_ip_prefix: "{{ prometheus_private_ip }}/32"
      - port: 9100
        remote_ip_prefix: "{{ prometheus_private_ip }}/32"
      - port: 9100
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
      - port: 9101
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
  - name: managesf
    rules:
      - port: 1883
      - port: 1884
      - port: 29418
      - port: 64738
      - port: 64738
        protocol: udp
  - name: hypervisor-oci
    rules:
      - port: 19885
      - port: 22022
        port_range_max: 65535
  - name: prometheus-mail
    rules:
      - port: 25
        remote_ip_prefix: "{{ prometheus_public_ip }}/32"
servers:
  - auto_ip: false
    boot_from_volume: yes
    flavor: v1-standard-2
    image: fedora-30-1.2
    key_name: sf-infra-key
    name: logreduce-mqtt-01.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
    volume_size: 80
  - auto_ip: true
    boot_from_volume: yes
    flavor: v1-standard-2
    image: centos-7-1907
    key_name: sf-infra-key
    name: prometheus.monitoring.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - web
    volume_size: 80
  - auto_ip: true
    boot_from_volume: yes
    flavor: v1-standard-2
    image: fedora-31-1.9
    key_name: sf-infra-key
    name: ara.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - web
    volume_size: 80
  - auto_ip: true
    boot_from_volume: yes
    flavor: v1-standard-8
    image: centos-7-1907
    key_name: sf-infra-key
    name: redhat-oss-git-stats.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - web
    volume_size: 500
  - boot_from_volume: yes
    flavor: v1-standard-2
    floating_ips:
      - "38.102.83.40"
    image: centos-7-1907
    key_name: sf-infra-key
    name: fedora.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - web
    volume_size: 40
  - boot_from_volume: yes
    flavor: v1-standard-2
    floating_ips:
      - "38.102.83.159"
    image: centos-7-1907
    key_name: sf-infra-key
    name: ovirt.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - web
    volume_size: 40
  - boot_from_volume: yes
    flavor: v1-standard-2
    floating_ips:
      - "38.102.83.251"
    image: centos-7-1907
    key_name: sf-infra-key
    name: ovirt-staging.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - web
    volume_size: 40
  - auto_ip: false
    boot_from_volume: yes
    flavor: v1-standard-2
    image: centos-7-1907
    key_name: sf-infra-key
    name: elk01.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
  - boot_from_volume: yes
    flavor: v1-standard-4
    floating_ips:
      - "38.102.83.76"
    image: centos-7-1907
    key_name: sf-infra-key
    name: managesf.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - web
      - managesf
    volume_size: 20
  - auto_ip: false
    boot_from_volume: yes
    flavor: v1-standard-2
    image: centos-7-1907
    key_name: sf-infra-key
    name: nodepool-builder.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
  - auto_ip: false
    boot_from_volume: yes
    flavor: v1-standard-2
    image: centos-7-1907
    key_name: sf-infra-key
    name: oci01.softwarefactory-project.io
    network: oci-private-network
    security_groups:
      - common
      - monitoring
      - hypervisor-oci
  - auto_ip: false
    boot_from_volume: yes
    flavor: v1-standard-2
    image: centos-7-1907
    key_name: sf-infra-key
    name: zs.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
  - boot_from_volume: yes
    flavor: 4vcpus_8gb
    floating_ips:
      - "38.102.83.102"
    image: centos-7-1907
    key_name: sf-infra-key
    name: koji.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
      - web
    volume_size: 80
  - auto_ip: false
    boot_from_volume: no
    flavor: 4vcpus_8gb
    image: centos-7-1907
    key_name: sf-infra-key
    name: ze01.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
  - auto_ip: false
    boot_from_volume: no
    flavor: 1vcpu_1gb
    image: centos-7-1907
    key_name: sf-infra-key
    name: zm01.softwarefactory-project.io
    network: private-network
    security_groups:
      - common
      - monitoring
subnets:
  - cidr: 192.168.242.0/24
    dns_nameservers:
      - "1.1.1.1"
      - "8.8.8.8"
    gateway_ip: "192.168.242.1"
    name: private-subnet
    network_name: private-network
  - cidr: 192.168.254.0/24
    dns_nameservers:
      - "1.1.1.1"
      - "8.8.8.8"
    gateway_ip: "192.168.254.1"
    name: oci-private-subnet
    network_name: oci-private-network
volumes:
  - device: /dev/vdb
    display_name: elk-data
    server: elk01.softwarefactory-project.io
    size: 160
  - device: /dev/vdb
    display_name: nodepool-builder-data
    server: nodepool-builder.softwarefactory-project.io
    size: 1000
